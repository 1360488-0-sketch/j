# 功能需求規格書 (PRD) - 貪食蛇遊戲控制方式擴展

## 文檔資訊
| 項目 | 內容 |
|------|------|
| **功能名稱** | WASD鍵盤控制與手機/平板虛擬方向鍵 |
| **版本** | 1.0 |
| **創建日期** | 2024年 |
| **狀態** | 已實現 |
| **優先級** | 高 |

## 1. 功能概述

### 1.1 功能簡介
在現有的貪食蛇遊戲基礎上，擴展控制方式以滿足不同用戶群體的需求：
- 為PC玩家增加WASD鍵盤控制方案
- 為移動設備用戶提供視覺化虛擬方向鍵界面
- 改善觸控設備的操作體驗

### 1.2 目標用戶
1. **PC遊戲玩家**：習慣使用WASD鍵盤控制的遊戲玩家
2. **移動設備用戶**：使用手機或平板電腦的觸控用戶
3. **多平台玩家**：在不同設備間切換的用戶

## 2. 問題陳述與需求分析

### 2.1 現有問題
1. **控制方式單一**：僅支持方向鍵控制，不滿足WASD習慣玩家
2. **移動設備體驗差**：沒有專為觸控設計的直觀控制界面
3. **用戶群體受限**：無法滿足不同操作習慣的玩家

### 2.2 需求分析
| 需求類型 | 描述 | 優先級 |
|----------|------|--------|
| **功能性需求** | 支持WASD鍵盤輸入 | 高 |
| **功能性需求** | 提供虛擬方向鍵界面 | 高 |
| **可用性需求** | 移動設備優化控制 | 高 |
| **可用性需求** | 按鈕觸控反饋 | 中 |
| **兼容性需求** | 多控制方式共存 | 中 |

## 3. 具體功能要求

### 3.1 WASD鍵盤控制功能
- **要求1**：支持W/A/S/D鍵控制蛇的移動方向
- **要求2**：與現有方向鍵控制邏輯兼容
- **要求3**：更新遊戲說明文檔
- **要求4**：提供視覺化的WASD鍵位說明

### 3.2 虛擬方向鍵功能
- **要求1**：設計四個方向（上、下、左、右）的虛擬按鈕
- **要求2**：按鈕需有明顯的視覺反饋（按下效果）
- **要求3**：僅在移動設備（手機/平板）顯示
- **要求4**：響應觸控事件，防止默認行為
- **要求5**：按鈕布局符合人體工學設計

### 3.3 響應式設計要求
- **要求1**：PC端隱藏虛擬方向鍵
- **要求2**：移動端自動顯示虛擬方向鍵
- **要求3**：不同屏幕尺寸的布局適應

## 4. 技術規格

### 4.1 輸入處理邏輯
```javascript
// 鍵盤事件處理（新增WASD支持）
switch(event.key.toLowerCase()) {
    case 'arrowup':
    case 'w':    // 新增W鍵支持
        if (direction !== 'down') nextDirection = 'up';
        break;
    case 'arrowdown':
    case 's':    // 新增S鍵支持
        if (direction !== 'up') nextDirection = 'down';
        break;
    // ... 其他方向處理
}
```

### 4.2 界面布局方案
```
虛擬方向鍵布局（3x2網格）：
┌─────┬─────┬─────┐
│     │  ↑  │     │
├─────┼─────┼─────┤
│  ←  │     │  →  │
├─────┼─────┼─────┤
│     │  ↓  │     │
└─────┴─────┴─────┘
```

### 4.3 視覺設計規範
| 元素 | 顏色 | 尺寸 | 動畫效果 |
|------|------|------|----------|
| 虛擬按鈕背景 | rgba(50, 60, 80, 0.9) | 70px×70px | 按下縮放0.95 |
| 按鈕文字 | #4CAF50 | 2rem | 無 |
| 按下狀態 | rgba(76, 175, 80, 0.7) | - | 150ms過渡 |

## 5. 用戶體驗設計

### 5.1 控制流程
```
用戶操作流程：
1. PC用戶：
   - 可選：方向鍵 或 WASD 控制
   - 空格鍵：暫停/繼續

2. 移動設備用戶：
   - 屏幕虛擬方向鍵控制
   - 滑動手勢控制（保留原有功能）
   - 按鈕有視覺反饋
```

### 5.2 界面布局
```
遊戲界面結構：
+-------------------------------+
|         遊戲標題              |
+-------------------------------+
|  [遊戲畫布]  |  [控制面板]    |
|              |                |
|              | - 得分顯示     |
|              | - 方向鍵說明   |
|              | - WASD說明     |
|              | - 控制按鈕     |
|              | - 遊戲狀態     |
+-------------------------------+
|    [移動設備虛擬方向鍵]       |
+-------------------------------+
```

## 6. 實施方案

### 6.1 代碼修改點
1. **HTML結構**：
   - 修復現有的HTML語法錯誤
   - 添加WASD說明區域
   - 完善虛擬方向鍵按鈕

2. **CSS樣式**：
   - 新增WASD控制樣式類
   - 虛擬方向鍵響應式設計
   - 按鈕互動效果

3. **JavaScript邏輯**：
   - 擴展鍵盤事件監聽
   - 虛擬按鈕事件處理
   - 觸控反饋實現

### 6.2 兼容性考慮
- **瀏覽器兼容**：支持主流瀏覽器（Chrome, Firefox, Safari, Edge）
- **設備兼容**：PC、平板、手機
- **輸入兼容**：鍵盤、觸控、滑動手勢

## 7. 測試方案

### 7.1 功能測試用例
| 測試項目 | 預期結果 | 測試方法 |
|----------|----------|----------|
| WASD鍵盤控制 | 蛇按正確方向移動 | 鍵盤輸入測試 |
| 虛擬按鈕控制 | 蛇按正確方向移動 | 觸控/點擊測試 |
| 響應式顯示 | 移動端顯示虛擬鍵 | 設備模擬測試 |
| 按鈕反饋 | 按鈕有視覺變化 | 點擊觀察測試 |
| 多控制共存 | 各種控制方式不衝突 | 組合操作測試 |

### 7.2 性能要求
- 虛擬按鈕響應時間：< 100ms
- 按鍵輸入延遲：< 50ms
- 移動設備觸控精度：準確識別按鈕區域

## 8. 風險與限制

### 8.1 已知限制
1. 虛擬按鈕在小屏幕設備上可能過於密集
2. 同時按下多個鍵盤按鍵可能導致衝突
3. 瀏覽器默認鍵盤事件可能需要阻止

### 8.2 緩解措施
1. 提供適當的按鈕間距和尺寸
2. 實現輸入防抖和方向限制邏輯
3. 使用 `event.preventDefault()` 阻止默認行為

## 9. 部署計劃

### 9.1 實施步驟
1. **第1階段**：修復現有HTML結構問題
2. **第2階段**：實現WASD鍵盤控制
3. **第3階段**：設計虛擬方向鍵界面
4. **第4階段**：實現觸控反饋和響應式設計
5. **第5階段**：測試和優化

### 9.2 發布檢查清單
- [x] HTML結構完整且無錯誤
- [x] WASD鍵盤控制正常工作
- [x] 虛擬方向鍵在移動設備顯示
- [x] 所有控制方式無衝突
- [x] 用戶界面說明已更新
- [x] 跨設備測試通過

## 10. 成功指標

### 10.1 量化指標
1. **使用率**：WASD控制和虛擬按鈕的使用比例
2. **操作準確率**：觸控操作的準確識別率
3. **用戶滿意度**：控制方式的易用性評分

### 10.2 質化指標
1. **學習曲線**：新用戶掌握控制方式的時間
2. **操作舒適度**：長時間遊戲的操作舒適感
3. **平台一致性**：不同設備間的操作體驗一致性

## 附件

### A. 現有代碼分析
```html
<!-- 問題代碼片段 -->
<button class="mobile-btn left" id="leftBtn">←</button>
<button="mobile-btn right" id="rightBtn">→</button>  <!-- 語法錯誤 -->
```

### B. 設計稿參考
（此處可添加界面設計圖或原型圖）

### C. 相關文檔
- 現有遊戲功能規格
- 用戶反饋收集
- 競爭產品分析

---

**批准簽署：**

| 角色 | 姓名 | 簽字 | 日期 |
|------|------|------|------|
| 產品負責人 | | | |
| 技術負責人 | | | |
| 設計負責人 | | | |
| 測試負責人 | | | |

**版本歷史：**

| 版本 | 日期 | 修改內容 | 修改人 |
|------|------|----------|--------|
| 1.0 | 2024年 | 初始版本 | AI助手 |
| 1.1 | | | |

---

**備註：**
本文檔詳細描述了貪食蛇遊戲控制方式擴展功能的完整規格，包括需求分析、技術實現、測試方案和部署計劃。功能已成功實現並集成到現有遊戲中。